# Terraform Plan Security Analyzer

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

## Overview

This repository contains a tool (and associated scripts/guides) designed to analyze the output of `terraform plan` and flag security-critical changes that might be introduced. Infrastructure-as-Code (IaC) offers immense benefits in terms of automation and reproducibility, but it also introduces the risk of inadvertently deploying insecure configurations. This tool helps mitigate that risk by automatically identifying potentially risky changes before they are applied.

The primary goal is to provide an extra layer of security scrutiny for your Terraform deployments, helping to catch potential issues that might otherwise be missed during manual reviews.

## Features

*   **Parses Terraform Plan Output:**  Reads and interprets the JSON output generated by `terraform plan -out=tfplan`.
*   **Identifies Security-Critical Changes:**  Flags modifications to security-sensitive resources like:
    *   Security Groups (adding/modifying ingress/egress rules)
    *   IAM Roles and Policies (granting excessive permissions)
    *   Storage Buckets (making them publicly accessible)
    *   Databases (enabling public access, disabling encryption)
    *   Networks (opening ports, modifying routing rules)
    *   KMS Keys (changing rotation settings, permissions)
    *   ...and more (extensible to support other resource types).
*   **Configurable Rules:** Allows customization of the analysis rules to adapt to your specific security requirements and policies. (e.g., define allowed ports, acceptable IAM permissions, etc.)
*   **Generates Reports:** Produces a clear and concise report summarizing the detected security concerns, with details on the affected resources and the nature of the changes.
*   **Integrates with CI/CD Pipelines:** Can be easily integrated into your CI/CD workflow (e.g., GitHub Actions, Jenkins, GitLab CI) to automatically analyze plans on each pull request or commit.
*   **Extensible Architecture:** Designed for easy extension to support new Terraform providers and resource types.

## Why This Is Important

*   **Prevent Security Misconfigurations:** Proactively identify and address security risks before they are deployed to your infrastructure.
*   **Enforce Security Policies:** Ensure that all Terraform changes adhere to your organization's security standards and best practices.
*   **Reduce Manual Review Effort:** Automate a significant portion of the security review process, freeing up security teams to focus on more complex issues.
*   **Shift-Left Security:** Integrate security checks early in the development lifecycle, making it easier and cheaper to fix issues.
*   **Improve Auditability:** Maintain a record of all security-related changes detected and addressed during the Terraform deployment process.

## How to Use

1.  **Generate Terraform Plan:**
    ```bash
    terraform plan -out=tfplan
    terraform show -json tfplan > tfplan.json
    ```

2.  **Run the Analyzer:**
    ```bash
    # Example using a Python script (analyzer.py - to be developed):
    python analyzer.py --plan tfplan.json --rules rules.yaml
    ```
    Or potentially:
    ```bash
    # Example using a shell script:
    ./analyze_plan.sh tfplan.json
    ```

3.  **Review the Report:**
    The analyzer will generate a report (e.g., `security_report.txt` or `security_report.json`) detailing any potential security issues.

4.  **Integrate with CI/CD:**
    Add a step to your CI/CD pipeline to execute the analyzer after the `terraform plan` step.  Configure the pipeline to fail if the analyzer detects any critical issues. (See "CI/CD Integration" section below for more details)

## Example Report (Conceptual)